!function(e){"use strict";function t(t,n){var i=Object.create(t);for(var e in n)i[e]=n[e];return n.toString!==Object.prototype.toString&&(i.toString=n.toString),i}function s(){}s.remove=function(t,n){var i=t.indexOf(n);return-1!=i&&(t.splice(i,1),!0)},s.now=function(){return Date.now()};function n(){}n.prototype={init:function(){},update:function(t){},draw:function(t){}};function i(){this.time=0}i.main=function(){u.init(i,{images:["me.png"]})},i.__super__=n,i.prototype=t(n.prototype,{init:function(){this.parent=g.get("me.png"),this.child=g.get("me.png"),this.child.set_interactive(!0),this.child.on_pointer_down=function(t){console.log("src/Main.hx:23:",t)},this.parent.get_position().set(u.width/2,u.height/2),this.parent.alpha=.5,this.parent.get_scale().set(.25,.25),this.child.get_scale().set(.5,.5),this.parent.add(this.child)},update:function(t){this.time+=t;var n=this.parent;n.set_angle(n.get_angle()+5*t),(n=this.child).set_x(n.get_x()+Math.sin(this.time)),(n=this.child).set_y(n.get_y()+Math.cos(this.time));var i=this.child.get_global_transform(),e=this.parent.get_global_transform(),o=this.child.get_rect();this.child_poly=x.apply_transform([y.get(o.get_left(),o.get_top()),y.get(o.get_right(),o.get_top()),y.get(o.get_right(),o.get_bottom()),y.get(o.get_left(),o.get_bottom())],i);o=this.parent.get_rect();this.parent_poly=x.apply_transform([y.get(o.get_left(),o.get_top()),y.get(o.get_right(),o.get_top()),y.get(o.get_right(),o.get_bottom()),y.get(o.get_left(),o.get_bottom())],e),i.put(),e.put()},draw:function(t){O.clear(t,16777215),O.sprite(t,this.parent),O.draw_poly(t,0,this.child_poly,4),O.draw_poly(t,0,this.parent_poly,4);for(var n=0,i=Math.floor(u.height/50);n<i;)for(var e=n++,o=0,s=Math.floor(u.width/50);o<s;){var h=o++;O.line(t,13684944,50*h,0,50*h,u.height,1,.02),O.line(t,13684944,0,50*e,u.width,50*e,1,.02)}for(n=0,i=Math.floor(u.height/100);n<i;)for(e=n++,o=0,s=Math.floor(u.width/100);o<s;){h=o++;O.line(t,8421504,100*h,0,100*h,u.height,2,.02),O.line(t,8421504,0,100*e,u.width,100*e,2,.02)}}});function l(){}l.hex=function(t,n){for(var i="";i="0123456789ABCDEF".charAt(15&t)+i,0<(t>>>=4););if(null!=n)for(;i.length<n;)i="0"+i;return i};function o(){}o.createInstance=function(t,n){return new(Function.prototype.bind.apply(t,[null].concat(n)))};function h(){this.h=Object.create(null)}function r(){}r.on_loading=function(t){},r.on_loaded=function(){},r.load=function(t,n,i){if(null!=t){if(null!=i&&(r.on_loading=i),null!=n&&(r.on_loaded=n),null!=t.images)for(var e=0,o=t.images;e<o.length;)r.load_image(o[e++]);if(null!=t.audio)for(e=0,o=t.audio;e<o.length;)r.load_audio(o[e++]);if(null!=t.text)for(e=0,o=t.text;e<o.length;)++e;r.check_load()}else null!=n&&n()},r.get_image=function(t){return r.images.h[t]},r.load_image=function(t){r.loaded.h[t]=!1;var n=window.document.createElement("img");n.src=t,n.style.display="none",window.document.body.appendChild(n),n.onload=function(){r.check_load(t)},r.images.h[t]=n},r.load_audio=function(t){r.loaded.h[t]=!1;var n=window.document.createElement("audio");n.src=t,n.style.display="none",window.document.body.appendChild(n),n.onload=function(){r.check_load(t)},n.loop=!1,r.audio.h[t]=n},r.check_load=function(t){null!=t&&(r.loaded.h[t]=!0);for(var n=0,i=0,e=r.loaded.h,o=Object.keys(e),s=o.length,h=0;h<s;){var a=h++;-1<i++&&1==e[o[a]]&&++n}r.on_loading(n/i),n==i&&r.on_loaded()};function a(){this.listeners=new h}a.prototype={listen:function(t,n){Object.prototype.hasOwnProperty.call(this.listeners.h,t)||(this.listeners.h[t]=[]),this.listeners.h[t].push(n)},dispatch:function(t,n){if(Object.prototype.hasOwnProperty.call(this.listeners.h,t))for(var i=0,e=this.listeners.h[t];i<e.length;)e[i++](n)},unlisten:function(t,n){if(null!=t||null!=n)if(null==t&&null!=n)for(var i=Object.keys(this.listeners.h),e=i.length,o=0;o<e;)s.remove(this.listeners.h[i[o++]],n);else null!=t&&null==n?this.listeners.h[t]=[]:Object.prototype.hasOwnProperty.call(this.listeners.h,t)&&s.remove(this.listeners.h[t],n)}};var u=function(){};u.init=function(t,n){u.width=window.innerWidth,u.height=window.innerHeight,u.init_scene=t,u.init_canvas(),u.init_events(),E.init(),v.init(),b.init(),_.init(u.ctx),r.load(n,u.on_loaded,_.draw)},u.init_events=function(){window.onresize=function(t){u.APP_EVENTS.dispatch(c.RESIZE,{width:window.innerWidth,height:window.innerHeight})},window.onfocus=function(t){u.APP_EVENTS.dispatch(c.FOCUS,{})},window.onblur=function(t){u.APP_EVENTS.dispatch(c.FOCUS_LOST,{})},u.APP_EVENTS.listen(c.FOCUS,function(t){u.active=!0}),u.APP_EVENTS.listen(c.FOCUS_LOST,function(t){u.active=!1}),u.APP_EVENTS.listen(c.RESIZE,function(t){u.width=window.innerWidth,u.height=window.innerHeight}),u.GAME_EVENTS.listen(p.UPDATE,function(t){u.scene.update(t.dt),u.scene.draw(u.ctx)})},u.init_canvas=function(){u.canvas=window.document.createElement("canvas"),u.ctx=u.canvas.getContext("2d",null),window.document.body.appendChild(u.canvas);function t(t){return u.canvas.width=t.width,u.canvas.height=t.height}t({width:u.width,height:u.height}),u.APP_EVENTS.listen(c.RESIZE,t)},u.on_loaded=function(){u.scene=o.createInstance(u.init_scene,[]),u.scene.init(),window.requestAnimationFrame(u.loop)},u.loop=function(t){var n;window.requestAnimationFrame(u.loop),!u.active&&(u.last=t)==t||(null==u.last&&(u.last=t),n=(t-u.last)/1e3,u.GAME_EVENTS.dispatch(p.PRE_UPDATE,{}),u.GAME_EVENTS.dispatch(p.UPDATE,{dt:n}),u.GAME_EVENTS.dispatch(p.POST_UPDATE,{}),u.last=t)};var c=function(){},p=function(){},_=function(){};_.init=function(t){_.ctx=t},_.draw=function(t){O.clear(_.ctx,0),O.draw_rect(_.ctx,-2236963,u.width/2-u.width/4,u.height/2-8,u.width/2,16,2),O.fill_rect(_.ctx,-2236963,u.width/2-u.width/4+4,u.height/2-4,(u.width/2-8)*t,8)};function f(){}f.get=function(t,n,i,e,o,s){return null==s&&(s=0),null==o&&(o=0),null==e&&(e=1),null==i&&(i=0),null==n&&(n=0),null==t&&(t=1),0<f.pool.length?f.pool.shift().set(t,n,i,e,o,s):(new f).set(t,n,i,e,o,s)},f.prototype={set:function(t,n,i,e,o,s){return this.a=t,this.b=n,this.c=i,this.d=e,this.tx=o,this.ty=s,this},put:function(){this.identity(),f.pool.push(this)},identity:function(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0},transform:function(t){this.scale(t.scale.x,t.scale.y),this.rotate(t.rotation),this.translate(t.position.x,t.position.y)},rotate:function(t){var n=Math.cos(t),i=Math.sin(t),e=this.a*n-this.b*i;this.b=this.a*i+this.b*n,this.a=e;var o=this.c*n-this.d*i;this.d=this.c*i+this.d*n,this.c=o;var s=this.tx*n-this.ty*i;this.ty=this.tx*i+this.ty*n,this.tx=s},scale:function(t,n){this.a*=t,this.b*=n,this.c*=t,this.d*=n,this.tx*=t,this.ty*=n},translate:function(t,n){this.tx+=t,this.ty+=n},to_transform:function(t,n){null==n&&(n=!1),null==t&&(t=w.get());var i,e,o=this.a*this.d-this.b*this.c;return t.position.set(this.tx,this.ty),0!=this.a||0!=this.b?(i=Math.sqrt(this.a*this.a+this.b*this.b),t.rotation=0<this.b?Math.acos(this.a/i):-Math.acos(this.a/i),t.scale.set(i,o/i)):0==this.c&&0==this.d||(e=Math.sqrt(this.c*this.c+this.d*this.d),t.rotation=Math.PI/2-(0<this.d?Math.acos(-this.c/e):-Math.acos(this.c/e)),t.scale.set(o/e,e)),n&&this.put(),t}};function d(){this.children=[],this.pivot=y.get(.5,.5),this.height=0,this.width=0,this.on_pointer_move=function(t){},this.on_pointer_up=function(t){},this.on_pointer_down=function(t){},this.interactive=!1,this.alpha=1,this.transform=w.get()}d.prototype={set_interactive:function(t){return t?u.GAME_EVENTS.listen(p.PRE_UPDATE,N(this,this.pre_update)):u.GAME_EVENTS.unlisten(p.PRE_UPDATE,N(this,this.pre_update)),this.interactive=t},get_position:function(){return this.transform.position},get_x:function(){return this.get_position().x},set_x:function(t){return this.get_position().x=t},get_y:function(){return this.get_position().y},set_y:function(t){return this.get_position().y=t},get_radians:function(){return this.transform.rotation},set_radians:function(t){return this.transform.rotation=t},get_angle:function(){return this.get_radians()*(180/Math.PI)},set_angle:function(t){return this.set_radians(t*Math.PI/180)},get_scale:function(){return this.transform.scale},get_rect:function(){return P.get(this.get_x()-this.width*this.pivot.x,this.get_y()-this.width*this.pivot.y,this.width,this.height)},get_matrix:function(){var t=f.get();t.transform(this.transform),t.translate(this.width*this.pivot.x,this.height*this.pivot.y);for(var n=this.parent;null!=n;)t.transform(n.transform),n=n.parent;return t.translate(-this.width*this.pivot.x,-this.height*this.pivot.y),t},pre_update:function(t){this.interactive&&b.add(this)},ctx_draw:function(t){t.save(),this.pre_draw(t),this.draw(t),this.post_draw(t),t.restore()},pre_draw:function(t){d.last_alpha=t.globalAlpha,t.globalAlpha=this.alpha,this.apply_transform_to_ctx(t)},draw:function(t){},post_draw:function(t){t.globalAlpha=d.last_alpha,this.draw_children(t)},draw_children:function(t){t.translate(this.width*this.pivot.x,this.height*this.pivot.y);for(var n=0,i=this.children;n<i.length;){var e=i[n];++n,e.pre_draw(t),e.draw(t),e.post_draw(t)}},apply_transform_to_ctx:function(t){t.translate(this.transform.position.x,this.transform.position.y),t.rotate(this.transform.rotation),t.scale(this.get_scale().x,this.get_scale().y),t.translate(-this.width*this.pivot.x,-this.height*this.pivot.y)},add:function(t,n){null!=t.parent&&t.parent.remove(t),t.parent=this,null==n?this.children.push(t):this.children.splice(n,0,t)},remove:function(t){t.parent=null,s.remove(this.children,t)},get_global_transform:function(){return this.get_matrix().to_transform(null,!0)}};var g=function(){this.frame=P.get(),d.call(this)};g.get=function(t){return 0<g.pool.length?g.pool.shift().reset(t):(new g).reset(t)},g.__super__=d,g.prototype=t(d.prototype,{reset:function(t,n,i){null==n&&(n=1);var e=this;return null!=i?this.transform.copy_from(i):(this.transform.to_default(),this.pivot.set(.5,.5)),this.alpha=n,this.image=r.get_image(t),null!=this.image?(this.width=this.image.width,this.height=this.image.height,this.frame.set(0,0,this.image.width,this.image.height)):r.load({images:[t]},function(){e.reset(t,e.alpha,e.transform)}),this},draw:function(t){null!=this.image&&t.drawImage(this.image,this.frame.x,this.frame.y,this.frame.width,this.frame.height,0,0,this.frame.width,this.frame.height)}});var w=function(){this.rotation=0,this.scale=y.get(1,1),this.position=y.get(0,0)};w.get=function(){return 0<w.pool.length?w.pool.shift().to_default():(new w).to_default()},w.prototype={to_default:function(){return this.position.set(0,0),this.scale.set(1,1),this.rotation=0,this},put:function(){w.pool.push(this)},copy_from:function(t){var n=t.position;this.position.set(n.x,n.y);n=t.scale;return this.scale.set(n.x,n.y),this.rotation=t.rotation,this}};var E=function(){};E.init=function(){window.document.addEventListener("keydown",function(t){E.set_key(t.key,!0)}),window.document.addEventListener("keyup",function(t){E.set_key(t.key,!1)}),u.GAME_EVENTS.listen(p.POST_UPDATE,function(t){for(var n=E.keys.h,i=Object.keys(n),e=i.length,o=0;o<e;){var s=i[o++];E.last.h[s]=n[s]}})},E.set_key=function(t,n){(E.keys.h[t]=n)&&(E.last_key=t)};var y=function(){this.y=0,this.x=0};y.get=function(t,n){return null==n&&(n=0),null==t&&(t=0),0<y.pool.length?y.pool.shift().set(t,n):(new y).set(t,n)},y.prototype={set:function(t,n){return null==n&&(n=0),null==t&&(t=0),this.x=t,this.y=n,this},put:function(){y.pool.push(this)}};var v=function(){};v.get_x=function(){return v.last_position.x},v.get_y=function(){return v.last_position.y},v.init=function(){window.document.addEventListener("pointermove",function(t){v.move(t.clientX,t.clientY,t.pointerId)}),window.document.addEventListener("pointerdown",function(t){v.down(t.clientX,t.clientY,t.pointerId)}),window.document.addEventListener("pointerup",function(t){v.up(t.clientX,t.clientY,t.pointerId)}),window.document.addEventListener("pointerout",function(t){v.out(t.pointerId)}),u.GAME_EVENTS.listen(p.POST_UPDATE,function(t){v.post_update()})},v.move=function(t,n,i){v.POINTER_EVENTS.dispatch(T.POINTER_MOVE,{id:i,x:t,y:n,type:T.POINTER_MOVE}),null!=v.touches[i]&&v.touches[i].set_position(t,n),v.last_position.set(t,n)},v.down=function(t,n,i){v.POINTER_EVENTS.dispatch(T.POINTER_DOWN,{id:i,x:t,y:n,type:T.POINTER_DOWN}),v.touches[i]=m.get(i,t,n),v.touches[i].just_touched=!0,v.last_position.set(t,n)},v.up=function(t,n,i){v.POINTER_EVENTS.dispatch(T.POINTER_UP,{id:i,x:t,y:n,type:T.POINTER_UP}),null!=v.touches[i]&&(v.touches[i].put(),v.touches[i]=null)},v.out=function(t){v.POINTER_EVENTS.dispatch(T.POINTER_OUT,{id:t,x:v.get_x(),y:v.get_y(),type:T.POINTER_OUT}),null!=v.touches[t]&&(v.touches[t].put(),v.touches[t]=null)},v.post_update=function(){for(var t=0,n=v.touches;t<n.length;){var i,e=n[t];++t,null!=e&&(e.just_touched=!1,i=e.position,e.last_position.set(i.x,i.y))}};var m=function(t,n,i){this.last_position=y.get(),this.position=y.get(),this.set(t,n,i)};m.get=function(t,n,i){return 0<m.pool.length?m.pool.shift().set(t,n,i):new m(t,n,i)},m.prototype={put:function(){m.pool.push(this)},set:function(t,n,i){return this.id=t,this.position.set(n,i),this},set_position:function(t,n){this.last_position.set(this.position.x,this.position.y),this.position.set(t,n)}};var T=function(){},x=function(){};x.contains_point=function(t,n){for(var i=!1,e=0,o=t.length-1;e<t.length;)t[e].y>n.y!=t[o].y>n.y&&n.x<(t[o].x-t[e].x)*(n.y-t[e].y)/(t[o].y-t[e].y)+t[e].x&&(i=!i),o=++e-1;return i},x.apply_transform=function(t,n){for(var i=0;i<t.length;){var e=t[i];++i;var o=n.position;e.set(e.x-o.x,e.y-o.y);var s=n.scale;e.set(e.x*s.x,e.y*s.y);var h=Math.atan2(e.y,e.x)+n.rotation,a=Math.sqrt(e.x*e.x+e.y*e.y);e.set(a*Math.cos(h),a*Math.sin(h));var l=n.position;e.set(e.x+l.x,e.y+l.y)}return t},x.put=function(t){for(var n=0;n<t.length;)t[n++].put()};var P=function(){this.height=0,this.width=0,this.y=0,this.x=0};P.get=function(t,n,i,e){return null==e&&(e=0),null==i&&(i=0),null==n&&(n=0),null==t&&(t=0),0==P.pool.length?(new P).set(t,n,i,e):P.pool.shift().set(t,n,i,e)},P.prototype={get_top:function(){return this.y},get_bottom:function(){return this.y+this.height},get_left:function(){return this.x},get_right:function(){return this.x+this.width},set:function(t,n,i,e){return null==e&&(e=0),null==i&&(i=0),null==n&&(n=0),null==t&&(t=0),this.x=t,this.y=n,this.width=i,this.height=e,this},put:function(){P.pool.push(this)}};var O=function(){};O.clear=function(t,n){t.clearRect(0,0,u.width,u.height),null!=n&&O.fill_rect(t,n,0,0,u.width,u.height)},O.line=function(t,n,i,e,o,s,h,a){null!=a&&(O.last_alpha=t.globalAlpha,t.globalAlpha=a),O.line_style(t,n,h),t.moveTo(i,e),t.lineTo(o,s),t.stroke(),null!=a&&(t.globalAlpha=O.last_alpha)},O.draw_poly=function(t,n,i,e,o){null!=o&&(O.last_alpha=t.globalAlpha,t.globalAlpha=o),O.line_style(t,n,e),t.beginPath(),t.moveTo(i[i.length-1].x,i[i.length-1].y);for(var s=0;s<i.length;){var h=i[s];++s,t.lineTo(h.x,h.y)}t.stroke(),null!=o&&(t.globalAlpha=O.last_alpha)},O.fill_rect=function(t,n,i,e,o,s,h){null!=h&&(O.last_alpha=t.globalAlpha,t.globalAlpha=h);var a="#"+l.hex(n>>16&255,2)+l.hex(n>>8&255,2)+l.hex(255&n,2);t.fillStyle=a,t.fillRect(i,e,o,s),null!=h&&(t.globalAlpha=O.last_alpha)},O.draw_rect=function(t,n,i,e,o,s,h,a){null!=a&&(O.last_alpha=t.globalAlpha,t.globalAlpha=a),O.line_style(t,n,h),t.strokeRect(i,e,o,s),null!=a&&(t.globalAlpha=O.last_alpha)},O.line_style=function(t,n,i,e){null!=e&&(O.last_alpha=t.globalAlpha,t.globalAlpha=e),t.lineWidth=null!=i?i:1;var o="#"+l.hex(n>>16&255,2)+l.hex(n>>8&255,2)+l.hex(255&n,2);return t.strokeStyle=o,t.beginPath(),null!=e&&(t.globalAlpha=O.last_alpha),t},O.sprite=function(t,n){n.ctx_draw(t)};var b=function(){};function N(t,n){return null==n?null:(null==n.__id__&&(n.__id__=e.$haxeUID++),null==t.hx__closures__?t.hx__closures__={}:i=t.hx__closures__[n.__id__],null==i&&(i=n.bind(t),t.hx__closures__[n.__id__]=i),i);var i}b.empty=function(){for(;0<b.stack.length;)b.stack.pop()},b.add=function(t){b.stack.unshift(t)},b.init=function(){v.POINTER_EVENTS.listen(T.POINTER_DOWN,function(t){b.events.push(t)}),v.POINTER_EVENTS.listen(T.POINTER_UP,function(t){b.events.push(t)}),v.POINTER_EVENTS.listen(T.POINTER_MOVE,function(t){b.events.push(t)}),u.GAME_EVENTS.listen(p.UPDATE,function(t){b.update()}),u.GAME_EVENTS.listen(p.POST_UPDATE,function(t){b.empty()})},b.update=function(){for(;0<b.events.length;){var t=b.events.shift();switch(t.type){case T.POINTER_DOWN:b.on_down(t);break;case T.POINTER_MOVE:b.on_move(t);break;case T.POINTER_UP:b.on_up(t);break;default:continue}}},b.on_down=function(t){for(var n=0,i=b.stack;n<i.length;){var e=i[n];if(++n,b.pointer_over_drawable(e,t))return void e.on_pointer_down(t)}},b.on_up=function(t){for(var n=0,i=b.stack;n<i.length;){var e=i[n];if(++n,b.pointer_over_drawable(e,t))return void e.on_pointer_up(t)}},b.on_move=function(t){for(var n=0,i=b.stack;n<i.length;){var e=i[n];if(++n,b.pointer_over_drawable(e,t))return void e.on_pointer_move(t)}},b.pointer_over_drawable=function(t,n){var i=t.get_rect(),e=[y.get(i.get_left(),i.get_top()),y.get(i.get_right(),i.get_top()),y.get(i.get_right(),i.get_bottom()),y.get(i.get_left(),i.get_bottom())],o=y.get(n.x,n.y),s=t.get_global_transform();x.apply_transform(e,s);var h=x.contains_point(e,o);return i.put(),o.put(),x.put(e),s.put(),h},e.$haxeUID|=0,"undefined"!=typeof performance&&"function"==typeof performance.now&&(s.now=performance.now.bind(performance)),r.images=new h,r.audio=new h,r.loaded=new h,u.APP_EVENTS=new a,u.GAME_EVENTS=new a,u.active=!0,c.RESIZE="RESIZE",c.FOCUS="FOCUS",c.FOCUS_LOST="FOCUS_LOST",p.UPDATE="UPDATE",p.PRE_UPDATE="PRE_UPDATE",p.POST_UPDATE="POST_UPDATE",f.pool=[],g.pool=[],w.pool=[],E.keys=new h,E.last=new h,y.pool=[],v.POINTER_EVENTS=new a,v.touches=[],v.last_position=y.get(),m.pool=[],T.POINTER_DOWN="POINTER_DOWN",T.POINTER_MOVE="POINTER_MOVE",T.POINTER_UP="POINTER_UP",T.POINTER_OUT="POINTER_OUT",P.pool=[],O.last_alpha=1,b.stack=[],b.events=[],i.main()}("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);